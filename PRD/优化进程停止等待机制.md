# 优化 RoxyBrowser 进程停止等待机制

## 背景

当前停止 RoxyBrowser 进程后使用固定 500ms 等待，可能因进程未完全退出导致后续文件操作（备份/恢复/清空）失败。

## 需求

1. 将 `stop_roxy()` 中的固定 500ms 等待替换为**轮询确认**机制，每 100ms 检查进程是否已退出
2. 设置 **10 秒**最大等待时间作为超时兜底，超时时向用户返回明确错误提示
3. 移除 `profile.rs` 中 3 处调用方的冗余 500ms 等待，因为 `stop_roxy()` 返回时已保证进程退出

## 涉及文件

- `src-tauri/src/commands/process.rs` — 修改 `stop_roxy()` 函数
- `src-tauri/src/commands/profile.rs` — 移除 `switch_user`、`prepare_for_new_user`、`finalize_new_user` 中的多余 sleep

## 验收标准

- 编译通过
- 正常停止、添加账户、切换用户流程无异常
- RoxyBrowser 未运行时调用停止不报错
- 进程 10 秒内未退出时给出明确错误提示
